benchmark_data = {
   "Find movies with the title 'Inception'.":{
      "pg.ts_rank":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.TF-IDF":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.BM25":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.TF-IDF":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      }
   },
   "Find movies with the title 'The Blue Lagoon'.":{
      "pg.ts_rank":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.TF-IDF":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.BM25":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.TF-IDF":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      }
   },
   "Find movies with the title 'She's Gotta Have It'.":{
      "pg.ts_rank":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":0.8666666666666667,
         "MAP":0.9920634920634921,
         "NDCG@10":0.99769277221392
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.8666666666666667,
         "MAP":0.9574074074074074,
         "NDCG@10":0.9857159827303459
      },
      "wo.BM25":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.TF-IDF":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      }
   },
   "Find movies with the title 'Mission: Impossible'.":{
      "pg.ts_rank":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":0.9,
         "MAP":0.9940476190476191,
         "NDCG@10":0.99826957916044
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.9,
         "MAP":0.9680555555555556,
         "NDCG@10":0.9892869870477594
      },
      "wo.BM25":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.TF-IDF":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      }
   },
   "Find movies with the title 'Connected'.":{
      "pg.ts_rank":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":1.0,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":0.9199999999999999,
         "MAP":0.9952380952380953,
         "NDCG@10":0.998615663328352
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.9199999999999999,
         "MAP":0.9744444444444443,
         "NDCG@10":0.9914295896382075
      },
      "wo.BM25":{
         "Precision@10":0.95,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "wo.TF-IDF":{
         "Precision@10":0.95,
         "MAP":1.0,
         "NDCG@10":1.0
      }
   },
   "Find movies based on real-life public figures or biographies":{
      "pg.ts_rank":{
         "Precision@10":0.9583333333333334,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":0.9583333333333334,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":0.85,
         "MAP":0.9838095238095238,
         "NDCG@10":0.9946368782497581
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.8666666666666666,
         "MAP":0.9215277777777776,
         "NDCG@10":0.954948087893098
      },
      "wo.BM25":{
         "Precision@10":0.9249999999999999,
         "MAP":0.9950810185185185,
         "NDCG@10":0.9986381844102495
      },
      "wo.TF-IDF":{
         "Precision@10":0.9249999999999999,
         "MAP":0.9950810185185185,
         "NDCG@10":0.9986381844102495
      }
   },
   "Discover shows on lawyer ":{
      "pg.ts_rank":{
         "Precision@10":0.9642857142857143,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pg.ts_rank_cd":{
         "Precision@10":0.9642857142857143,
         "MAP":1.0,
         "NDCG@10":1.0
      },
      "pyluc.BM25":{
         "Precision@10":0.8285714285714285,
         "MAP":0.950578231292517,
         "NDCG@10":0.9813273992876406
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.8428571428571427,
         "MAP":0.8864067055393585,
         "NDCG@10":0.9400654750881375
      },
      "wo.BM25":{
         "Precision@10":0.9214285714285715,
         "MAP":0.9731016943814562,
         "NDCG@10":0.9873536109728056
      },
      "wo.TF-IDF":{
         "Precision@10":0.9214285714285715,
         "MAP":0.9731016943814562,
         "NDCG@10":0.9873536109728056
      }
   },
   "Identify thrillers on love revenge.":{
      "pg.ts_rank":{
         "Precision@10":0.90625,
         "MAP":0.9524305555555556,
         "NDCG@10":0.9596350182597604
      },
      "pg.ts_rank_cd":{
         "Precision@10":0.90625,
         "MAP":0.9524305555555556,
         "NDCG@10":0.9596350182597604
      },
      "pyluc.BM25":{
         "Precision@10":0.775,
         "MAP":0.8805282738095238,
         "NDCG@10":0.9352146503505268
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.7875000000000001,
         "MAP":0.825767077664399,
         "NDCG@10":0.8996943371018983
      },
      "wo.BM25":{
         "Precision@10":0.91875,
         "MAP":0.9674968309082892,
         "NDCG@10":0.9860613308886189
      },
      "wo.TF-IDF":{
         "Precision@10":0.91875,
         "MAP":0.9674968309082892,
         "NDCG@10":0.9860613308886189
      }
   },
   "Explore stories of young superheroes":{
      "pg.ts_rank":{
         "Precision@10":0,
         "MAP":0,
         "NDCG@10":0
      },
      "pg.ts_rank_cd":{
         "Precision@10":0,
         "MAP":0,
         "NDCG@10":0
      },
      "pyluc.BM25":{
         "Precision@10":0.7666666666666667,
         "MAP":0.8490561224489795,
         "NDCG@10":0.9106240348488635
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.7666666666666667,
         "MAP":0.7984772612748803,
         "NDCG@10":0.8773323657252408
      },
      "wo.BM25":{
         "Precision@10":0.9055555555555556,
         "MAP":0.9314147315304722,
         "NDCG@10":0.9583576718197434
      },
      "wo.TF-IDF":{
         "Precision@10":0.9055555555555556,
         "MAP":0.9314147315304722,
         "NDCG@10":0.9583576718197434
      }
   },
   "Based on a true story":{
      "pg.ts_rank":{
         "Precision@10":0.8944444444444445,
         "MAP":0.935945488788626,
         "NDCG@10":0.9323037951472904
      },
      "pg.ts_rank_cd":{
         "Precision@10":0.8944444444444445,
         "MAP":0.9439701801466508,
         "NDCG@10":0.9462263953615716
      },
      "pyluc.BM25":{
         "Precision@10":0.78,
         "MAP":0.8547545666414713,
         "NDCG@10":0.9162331106345762
      },
      "pyluc.TF-IDF":{
         "Precision@10":0.78,
         "MAP":0.8092335915847819,
         "NDCG@10":0.8862706084233158
      },
      "wo.BM25":{
         "Precision@10":0.905,
         "MAP":0.9359275793650792,
         "NDCG@10":0.9619013832010908
      },
      "wo.TF-IDF":{
         "Precision@10":0.905,
         "MAP":0.9359275793650792,
         "NDCG@10":0.9619013832010908
      }
   }
}



import matplotlib.pyplot as plt
import numpy as np
benchmark = benchmark_data
ranking_models = set()
for query_data in benchmark.values():
    ranking_models.update(query_data.keys())

ranking_models = sorted(ranking_models)

# KPI
kpis = ["Precision@10", "MAP", "NDCG@10"]

# Calcolo delle medie per ogni ranking model e KPI
results = {kpi: {model: [] for model in ranking_models} for kpi in kpis}

for query_data in benchmark.values():
    for model, metrics in query_data.items():
        for kpi in kpis:
            results[kpi][model].append(metrics[kpi])

# Media per KPI e modello
avg_results = {kpi: {model: np.mean(values) for model, values in models.items()} for kpi, models in results.items()}

# Plot
fig, ax = plt.subplots(1, len(kpis), figsize=(18, 5), sharey=True)
x = np.arange(len(ranking_models))
width = 0.6

for i, kpi in enumerate(kpis):
    values = [avg_results[kpi][model] for model in ranking_models]
    ax[i].bar(x, values, width)
    ax[i].set_xticks(x)
    ax[i].set_xticklabels(ranking_models, rotation=90)
    ax[i].set_title(kpi)
    ax[i].set_ylim(0, 1.1)

fig.suptitle("Performance media per KPI e motore di ricerca")
plt.tight_layout()
plt.show()




"""
# Raggruppa i valori medi per motore
results = {}
for query_results in benchmark_data.values():
    for engine, metrics in query_results.items():
        if engine not in results:
            results[engine] = {"Precision@10": [], "MAP": [], "NDCG@10": []}
        for metric in metrics:
            results[engine][metric].append(metrics[metric])

# Calcola la media
avg_results = {
    engine: {
        metric: np.mean(values) for metric, values in metrics.items()
    } for engine, metrics in results.items()
}

# Organizza per grafico
engines = list(avg_results.keys())
metrics = ["Precision@10", "MAP", "NDCG@10"]
data = {metric: [avg_results[engine][metric] for engine in engines] for metric in metrics}
print(data)
x = np.arange(len(engines))
width = 0.25

# Disegna grafico
fig, ax = plt.subplots(figsize=(12, 6))
for i, metric in enumerate(metrics):
    ax.bar(x + i*width, data[metric], width, label=metric)

ax.set_ylabel('Score medio')
ax.set_title('Performance media per motore di ricerca e modello di ranking')
ax.set_xticks(x + width)
ax.set_xticklabels(engines, rotation=45, ha='right')
ax.legend()
ax.grid(True, linestyle='--', alpha=0.5)

plt.tight_layout()
plt.show()"""